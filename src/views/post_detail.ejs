<%- include('common/header', { user: typeof user !== 'undefined' ? user : null, title: post ? post.title : '게시글' }) %>

<div class="card">
    <% if (post) { %>
        <div class="post-header">
            <h1><%= post.title %></h1>
            <div class="post-meta">
                <span>작성자: <%= post.writer ? post.writer.name : 'N/A' %></span> |
                <span>작성일: <%= post.createdAt ? new Date(post.createdAt).toLocaleString('ko-KR') : '-' %></span> |
                <span>타입: <%= postTypeDisplayNames[post.post_type] || post.post_type %></span>
            </div>
        </div>
        <div class="post-content">
            <%- post.contents.replace(/\\n/g, '<br>') %>

            <% if (post.mp4_url) { %>
                <div class="mt-4">
                    <video class="video-js" controls preload="auto" poster="/static/img/default-poster.jpg" data-setup="{}">
                        <source src="<%= post.mp4_url %>" type="video/mp4">
                        브라우저가 비디오 태그를 지원하지 않습니다.
                    </video>
                </div>
            <% } %>
        </div>
    <% } else { %>
        <div class="card-body">
            <h1 class="text-center">게시글을 찾을 수 없습니다.</h1>
        </div>
    <% } %>
</div>
<div class="mt-4 d-flex justify-content-between">
    <a href="/post/posts" class="btn btn-secondary">목록으로 돌아가기</a>
    <% if (user && post && post.writer && user.id === post.writer.id) { %>
        <a href="/post/posts/<%= post.id %>/edit" class="btn btn-primary">수정하기</a>
    <% } %>
</div>

<%- include('common/footer') %>
